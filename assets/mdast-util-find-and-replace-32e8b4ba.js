import{c as k}from"./unist-util-is-23f17141.js";import{v as P}from"./unist-util-visit-parents-72556a0a.js";function I(e){if(typeof e!="string")throw new TypeError("Expected a string");return e.replace(/[|\\{}()[\]^$+*?.]/g,"\\$&").replace(/-/g,"\\x2d")}const T={}.hasOwnProperty,S=function(e,l,t,b){let f,g;typeof l=="string"||l instanceof RegExp?(g=[[l,t]],f=b):(g=l,f=t),f||(f={});const A=k(f.ignore||[]),x=$(g);let h=-1;for(;++h<x.length;)P(e,"text",O);return e;function O(n,o){let u=-1,i;for(;++u<o.length;){const a=o[u];if(A(a,i?i.children.indexOf(a):void 0,i))return;i=a}if(i)return R(n,o)}function R(n,o){const u=o[o.length-1],i=x[h][0],a=x[h][1];let p=0;const d=u.children.indexOf(n);let v=!1,s=[];i.lastIndex=0;let c=i.exec(n.value);for(;c;){const y=c.index,j={index:c.index,input:c.input,stack:[...o,n]};let r=a(...c,j);if(typeof r=="string"&&(r=r.length>0?{type:"text",value:r}:void 0),r!==!1&&(p!==y&&s.push({type:"text",value:n.value.slice(p,y)}),Array.isArray(r)?s.push(...r):r&&s.push(r),p=y+c[0].length,v=!0),!i.global)break;c=i.exec(n.value)}return v?(p<n.value.length&&s.push({type:"text",value:n.value.slice(p)}),u.children.splice(d,1,...s)):s=[n],d+s.length}};function $(e){const l=[];if(typeof e!="object")throw new TypeError("Expected array or object as schema");if(Array.isArray(e)){let t=-1;for(;++t<e.length;)l.push([w(e[t][0]),E(e[t][1])])}else{let t;for(t in e)T.call(e,t)&&l.push([w(t),E(e[t])])}return l}function w(e){return typeof e=="string"?new RegExp(I(e),"g"):e}function E(e){return typeof e=="function"?e:()=>e}export{S as f};
