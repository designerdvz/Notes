import{t as b}from"./hast-util-to-string-00227f59.js";import{n as U}from"./parse-numeric-range-9ea3a738.js";import{r as W}from"./refractor-49dd922f.js";import{v as q}from"./unist-util-visit-00dde69f.js";import{f as z}from"./unist-util-filter-604d5ec3.js";function j(){j=function(l,i){return new o(l,void 0,i)};var r=RegExp.prototype,t=new WeakMap;function o(l,i,c){var h=new RegExp(l,i);return t.set(h,c||t.get(l)),N(h,o.prototype)}function e(l,i){var c=t.get(i);return Object.keys(c).reduce(function(h,p){return h[p]=l[c[p]],h},Object.create(null))}return B(o,RegExp),o.prototype.exec=function(l){var i=r.exec.call(this,l);return i&&(i.groups=e(i,this)),i},o.prototype[Symbol.replace]=function(l,i){if(typeof i=="string"){var c=t.get(this);return r[Symbol.replace].call(this,l,i.replace(/\$<([^>]+)>/g,function(p,f){return"$"+c[f]}))}if(typeof i=="function"){var h=this;return r[Symbol.replace].call(this,l,function(){var p=arguments;return typeof p[p.length-1]!="object"&&(p=[].slice.call(p)).push(e(p,h)),i.apply(this,p)})}return r[Symbol.replace].call(this,l,i)},j.apply(this,arguments)}function B(r,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");r.prototype=Object.create(t&&t.prototype,{constructor:{value:r,writable:!0,configurable:!0}}),Object.defineProperty(r,"prototype",{writable:!1}),t&&N(r,t)}function N(r,t){return N=Object.setPrototypeOf||function(o,e){return o.__proto__=e,o},N(r,t)}function _(r,t){(t==null||t>r.length)&&(t=r.length);for(var o=0,e=new Array(t);o<t;o++)e[o]=r[o];return e}function S(r,t){var o=typeof Symbol<"u"&&r[Symbol.iterator]||r["@@iterator"];if(o)return(o=o.call(r)).next.bind(o);if(Array.isArray(r)||(o=function(l,i){if(l){if(typeof l=="string")return _(l,i);var c=Object.prototype.toString.call(l).slice(8,-1);return c==="Object"&&l.constructor&&(c=l.constructor.name),c==="Map"||c==="Set"?Array.from(l):c==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(c)?_(l,i):void 0}}(r))||t&&r&&typeof r.length=="number"){o&&(r=o);var e=0;return function(){return e>=r.length?{done:!0}:{done:!1,value:r[e++]}}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var D=function(r){return function(t){return t===void 0&&(t={}),function(e){q(e,"element",o)};function o(e,l,i){var c,h;if(i&&i.tagName==="pre"&&e.tagName==="code"){var p=(e==null||(c=e.data)==null?void 0:c.meta)||(e==null||(h=e.properties)==null?void 0:h.metastring)||"";e.properties.className?typeof e.properties.className=="boolean"?e.properties.className=[]:Array.isArray(e.properties.className)||(e.properties.className=[e.properties.className]):e.properties.className=[],e.properties.className.push("code-highlight");var f,g,m=function(a){for(var s,n=S(a.properties.className);!(s=n()).done;){var u=s.value;if(u.slice(0,9)==="language-")return u.slice(9).toLowerCase()}return null}(e);if(m)try{var w;w=m!=null&&m.includes("diff-")?m.split("-")[1]:m,f=r.highlight(b(e),w),i.properties.className=(i.properties.className||[]).concat("language-"+w)}catch(a){if(!t.ignoreMissing||!/Unknown language/.test(a.message))throw a;f=e}else f=e;f.children=(g=1,function a(s){return s.reduce(function(n,u){if(u.type==="text"){var d=u.value,y=(d.match(/\n/g)||"").length;if(y===0)u.position={start:{line:g,column:1},end:{line:g,column:1}},n.push(u);else for(var A,L=d.split(`
`),$=S(L.entries());!(A=$()).done;){var C=A.value,x=C[0],E=C[1];n.push({type:"text",value:x===L.length-1?E:E+`
`,position:{start:{line:g+x,column:1},end:{line:g+x,column:1}}})}return g+=y,n}if(Object.prototype.hasOwnProperty.call(u,"children")){var T=g;return u.children=a(u.children),n.push(u),u.position={start:{line:T,column:1},end:{line:g,column:1}},n}return n.push(u),n},[])})(f.children),f.position=f.children.length>0?{start:{line:f.children[0].position.start.line,column:0},end:{line:f.children[f.children.length-1].position.end.line,column:0}}:{start:{line:0,column:0},end:{line:0,column:0}};for(var O,k=function(a){var s=/{([\d,-]+)}/,n=a.split(",").map(function(y){return y.trim()}).join();if(s.test(n)){var u=s.exec(n)[1],d=U(u);return function(y){return d.includes(y+1)}}return function(){return!1}}(p),I=function(a){var s=j(/showLineNumbers=([0-9]+)/i,{lines:1});if(s.test(a)){var n=s.exec(a);return Number(n.groups.lines)}return 1}(p),v=function(a){for(var s=new Array(a),n=0;n<a;n++)s[n]={type:"element",tagName:"span",properties:{className:[]},children:[]};return s}(f.position.end.line),M=["showlinenumbers=false",'showlinenumbers="false"',"showlinenumbers={false}"],P=function(){var a=O.value,s=a[0],n=a[1];n.properties.className=["code-line"];var u=z(f,function(d){return d.position.start.line<=s+1&&d.position.end.line>=s+1});n.children=u.children,!p.toLowerCase().includes("showLineNumbers".toLowerCase())&&!t.showLineNumbers||M.some(function(d){return p.toLowerCase().includes(d)})||(n.properties.line=[(s+I).toString()],n.properties.className.push("line-number")),k(s)&&n.properties.className.push("highlight-line"),(m==="diff"||m!=null&&m.includes("diff-"))&&b(n).substring(0,1)==="-"?n.properties.className.push("deleted"):(m==="diff"||m!=null&&m.includes("diff-"))&&b(n).substring(0,1)==="+"&&n.properties.className.push("inserted")},R=S(v.entries());!(O=R()).done;)P();v.length>0&&b(v[v.length-1]).trim()===""&&v.pop(),e.children=v}}}},Q=D(W);export{Q as m};
